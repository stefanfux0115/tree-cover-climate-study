2025-08-02 02:08:45,985 - __main__ - INFO - Starting comprehensive feature engineering...
2025-08-02 02:08:45,985 - __main__ - INFO - Loading ML datasets...
2025-08-02 02:08:49,273 - __main__ - INFO - Loaded train: 12,109,326 rows
2025-08-02 02:08:50,295 - __main__ - INFO - Loaded validation: 2,717,703 rows
2025-08-02 02:08:51,228 - __main__ - INFO - Loaded test: 2,717,694 rows
2025-08-02 02:08:56,530 - __main__ - INFO - Loaded full: 17,544,723 rows
2025-08-02 02:08:56,958 - __main__ - INFO - Processing train split...
2025-08-02 02:08:56,958 - __main__ - INFO - Engineering features for train split...
2025-08-02 02:08:56,958 - __main__ - INFO - Creating humidity bins...
2025-08-02 02:09:05,128 - __main__ - INFO - Created humidity bins: ['RH_low', 'RH_mid', 'RH_high']
2025-08-02 02:09:05,679 - __main__ - INFO - Humidity distribution: {'RH_high': 6112570, 'RH_mid': 5639590, 'RH_low': 357166}
2025-08-02 02:09:05,684 - __main__ - INFO - Creating precipitation bins...
2025-08-02 02:09:15,561 - __main__ - INFO - Created precipitation bins: ['rain_days_0_1mm', 'rain_days_1_10mm', 'rain_days_10_plus']
2025-08-02 02:09:16,193 - __main__ - INFO - Precipitation distribution: {'rain_days_0_1mm': 11658679, 'rain_days_10_plus': 408510, 'rain_days_1_10mm': 42137}
2025-08-02 02:09:16,733 - __main__ - INFO - Creating socioeconomic bins...
2025-08-02 02:09:23,939 - __main__ - INFO - GDP categories created with quantiles: [ 9319. 13795.]
2025-08-02 02:09:29,636 - __main__ - INFO - Population categories created with quantiles: [107. 621.]
2025-08-02 02:09:36,496 - __main__ - INFO - Nightlight categories created: ['rural', 'urban_low', 'urban_high']
2025-08-02 02:09:37,065 - __main__ - INFO - Creating canopy bins...
2025-08-02 02:09:48,029 - __main__ - INFO - Canopy categories: ['no_canopy', 'low_canopy', 'medium_canopy', 'high_canopy']
2025-08-02 02:09:48,816 - __main__ - INFO - Canopy distribution: {'no_canopy': 8345417, 'high_canopy': 1857320, 'unknown': 1736554, 'medium_canopy': 170035}
2025-08-02 02:09:49,537 - __main__ - INFO - Creating enhanced temperature features...
2025-08-02 02:09:59,224 - __main__ - INFO - Created enhanced temperature features
2025-08-02 02:10:00,035 - __main__ - INFO - Creating seasonal features...
2025-08-02 02:10:12,965 - __main__ - INFO - Created seasonal features
2025-08-02 02:10:13,737 - __main__ - INFO - Creating two-way interactions...
2025-08-02 02:10:17,681 - __main__ - INFO - Created 2 two-way interaction features
2025-08-02 02:10:18,886 - __main__ - INFO - Removing redundant categorical columns...
2025-08-02 02:10:21,170 - __main__ - INFO - Removed 7 categorical columns
2025-08-02 02:10:22,950 - __main__ - INFO - Feature engineering completed for train: 83 features
2025-08-02 02:10:22,950 - __main__ - INFO - Processing validation split...
2025-08-02 02:10:23,670 - __main__ - INFO - Engineering features for validation split...
2025-08-02 02:10:23,670 - __main__ - INFO - Creating humidity bins...
2025-08-02 02:10:26,141 - __main__ - INFO - Created humidity bins: ['RH_low', 'RH_mid', 'RH_high']
2025-08-02 02:10:26,265 - __main__ - INFO - Humidity distribution: {'RH_high': 1369090, 'RH_mid': 1224071, 'RH_low': 124542}
2025-08-02 02:10:26,265 - __main__ - INFO - Creating precipitation bins...
2025-08-02 02:10:27,552 - __main__ - INFO - Created precipitation bins: ['rain_days_0_1mm', 'rain_days_1_10mm', 'rain_days_10_plus']
2025-08-02 02:10:27,695 - __main__ - INFO - Precipitation distribution: {'rain_days_0_1mm': 2717703}
2025-08-02 02:10:27,762 - __main__ - INFO - Creating socioeconomic bins...
2025-08-02 02:10:29,275 - __main__ - INFO - GDP categories created with quantiles: [10951. 16171.]
2025-08-02 02:10:30,662 - __main__ - INFO - Population categories created with quantiles: [146. 758.]
2025-08-02 02:10:32,324 - __main__ - INFO - Nightlight categories created: ['rural', 'urban_low', 'urban_high']
2025-08-02 02:10:32,448 - __main__ - INFO - Creating canopy bins...
2025-08-02 02:10:34,262 - __main__ - INFO - Canopy categories: ['no_canopy', 'low_canopy', 'medium_canopy', 'high_canopy']
2025-08-02 02:10:34,510 - __main__ - INFO - Canopy distribution: {'unknown': 2078607, 'no_canopy': 539976, 'high_canopy': 85446, 'medium_canopy': 13674}
2025-08-02 02:10:34,667 - __main__ - INFO - Creating enhanced temperature features...
2025-08-02 02:10:37,038 - __main__ - INFO - Created enhanced temperature features
2025-08-02 02:10:37,177 - __main__ - INFO - Creating seasonal features...
2025-08-02 02:10:39,268 - __main__ - INFO - Created seasonal features
2025-08-02 02:10:39,408 - __main__ - INFO - Creating two-way interactions...
2025-08-02 02:10:40,049 - __main__ - INFO - Created 2 two-way interaction features
2025-08-02 02:10:40,195 - __main__ - INFO - Removing redundant categorical columns...
2025-08-02 02:10:40,548 - __main__ - INFO - Removed 7 categorical columns
2025-08-02 02:10:40,894 - __main__ - INFO - Feature engineering completed for validation: 81 features
2025-08-02 02:10:40,894 - __main__ - INFO - Processing test split...
2025-08-02 02:10:40,977 - __main__ - INFO - Engineering features for test split...
2025-08-02 02:10:40,977 - __main__ - INFO - Creating humidity bins...
2025-08-02 02:10:43,224 - __main__ - INFO - Created humidity bins: ['RH_low', 'RH_mid', 'RH_high']
2025-08-02 02:10:43,340 - __main__ - INFO - Humidity distribution: {'RH_mid': 1359069, 'RH_high': 1217096, 'RH_low': 141529}
2025-08-02 02:10:43,342 - __main__ - INFO - Creating precipitation bins...
2025-08-02 02:10:44,636 - __main__ - INFO - Created precipitation bins: ['rain_days_0_1mm', 'rain_days_1_10mm', 'rain_days_10_plus']
2025-08-02 02:10:44,836 - __main__ - INFO - Precipitation distribution: {'rain_days_0_1mm': 2717694}
2025-08-02 02:10:44,899 - __main__ - INFO - Creating socioeconomic bins...
2025-08-02 02:10:46,350 - __main__ - INFO - GDP categories created with quantiles: [11480. 17118.]
2025-08-02 02:10:47,694 - __main__ - INFO - Population categories created with quantiles: [147. 760.]
2025-08-02 02:10:49,000 - __main__ - INFO - Nightlight categories created: ['rural', 'urban_low', 'urban_high']
2025-08-02 02:10:49,099 - __main__ - INFO - Creating canopy bins...
2025-08-02 02:10:50,805 - __main__ - INFO - Canopy categories: ['no_canopy', 'low_canopy', 'medium_canopy', 'high_canopy']
2025-08-02 02:10:50,938 - __main__ - INFO - Canopy distribution: {'unknown': 2078510, 'no_canopy': 540760, 'high_canopy': 83377, 'medium_canopy': 15047}
2025-08-02 02:10:51,062 - __main__ - INFO - Creating enhanced temperature features...
2025-08-02 02:10:53,224 - __main__ - INFO - Created enhanced temperature features
2025-08-02 02:10:53,370 - __main__ - INFO - Creating seasonal features...
2025-08-02 02:10:55,438 - __main__ - INFO - Created seasonal features
2025-08-02 02:10:55,575 - __main__ - INFO - Creating two-way interactions...
2025-08-02 02:10:56,284 - __main__ - INFO - Created 2 two-way interaction features
2025-08-02 02:10:56,433 - __main__ - INFO - Removing redundant categorical columns...
2025-08-02 02:10:56,797 - __main__ - INFO - Removed 7 categorical columns
2025-08-02 02:10:57,082 - __main__ - INFO - Feature engineering completed for test: 81 features
2025-08-02 02:10:57,083 - __main__ - INFO - Validating engineered features...
2025-08-02 02:11:07,607 - __main__ - INFO - Feature Engineering Validation:
2025-08-02 02:11:07,607 - __main__ - INFO -   Total features: 83
2025-08-02 02:11:07,607 - __main__ - INFO -   original: 56 features
2025-08-02 02:11:07,607 - __main__ - INFO -   temperature_derived: 7 features
2025-08-02 02:11:07,607 - __main__ - INFO -   categorical_dummies: 26 features
2025-08-02 02:11:07,607 - __main__ - INFO -   interactions: 14 features
2025-08-02 02:11:07,607 - __main__ - INFO -   seasonal: 6 features
2025-08-02 02:11:07,607 - __main__ - INFO -   Missing data columns: 17
2025-08-02 02:11:26,717 - __main__ - INFO - Saved train engineered dataset: G:\research\junmao-tang\code-test\code-space\data\processed\ml_analysis\engineered\train_engineered.parquet
2025-08-02 02:11:30,491 - __main__ - INFO - Saved validation engineered dataset: G:\research\junmao-tang\code-test\code-space\data\processed\ml_analysis\engineered\validation_engineered.parquet
2025-08-02 02:11:34,334 - __main__ - INFO - Saved test engineered dataset: G:\research\junmao-tang\code-test\code-space\data\processed\ml_analysis\engineered\test_engineered.parquet
2025-08-02 02:11:34,342 - __main__ - INFO - Saved feature engineering metadata: G:\research\junmao-tang\code-test\code-space\data\processed\ml_analysis\engineered\feature_engineering_metadata.json
2025-08-02 02:11:34,342 - __main__ - INFO - Saved feature list: G:\research\junmao-tang\code-test\code-space\data\processed\ml_analysis\engineered\feature_list.json
2025-08-02 02:11:34,342 - __main__ - INFO - Feature engineering completed successfully!
