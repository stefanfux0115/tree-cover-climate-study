2025-08-02 02:05:22,145 - __main__ - INFO - Starting comprehensive feature engineering...
2025-08-02 02:05:22,145 - __main__ - INFO - Loading ML datasets...
2025-08-02 02:05:25,598 - __main__ - INFO - Loaded train: 12,109,326 rows
2025-08-02 02:05:26,458 - __main__ - INFO - Loaded validation: 2,717,703 rows
2025-08-02 02:05:27,367 - __main__ - INFO - Loaded test: 2,717,694 rows
2025-08-02 02:05:32,715 - __main__ - INFO - Loaded full: 17,544,723 rows
2025-08-02 02:05:33,188 - __main__ - INFO - Processing train split...
2025-08-02 02:05:33,188 - __main__ - INFO - Engineering features for train split...
2025-08-02 02:05:33,188 - __main__ - INFO - Creating humidity bins...
2025-08-02 02:05:41,395 - __main__ - INFO - Created humidity bins: ['RH_low', 'RH_mid', 'RH_high']
2025-08-02 02:05:42,021 - __main__ - INFO - Humidity distribution: {'RH_high': 6112570, 'RH_mid': 5639590, 'RH_low': 357166}
2025-08-02 02:05:42,026 - __main__ - INFO - Creating precipitation bins...
2025-08-02 02:05:50,612 - __main__ - INFO - Created precipitation bins: ['rain_days_0_1mm', 'rain_days_1_10mm', 'rain_days_10_plus']
2025-08-02 02:05:51,231 - __main__ - INFO - Precipitation distribution: {'rain_days_0_1mm': 11658679, 'rain_days_10_plus': 408510, 'rain_days_1_10mm': 42137}
2025-08-02 02:05:51,803 - __main__ - INFO - Creating socioeconomic bins...
2025-08-02 02:05:59,458 - __main__ - INFO - GDP categories created with quantiles: [ 9319. 13795.]
2025-08-02 02:06:06,455 - __main__ - INFO - Population categories created with quantiles: [107. 621.]
2025-08-02 02:06:14,079 - __main__ - INFO - Nightlight categories created: ['rural', 'urban_low', 'urban_high']
2025-08-02 02:06:14,608 - __main__ - INFO - Creating canopy bins...
2025-08-02 02:06:23,609 - __main__ - INFO - Canopy categories: ['no_canopy', 'low_canopy', 'medium_canopy', 'high_canopy']
2025-08-02 02:06:24,181 - __main__ - INFO - Canopy distribution: {'no_canopy': 8345417, 'high_canopy': 1857320, 'unknown': 1736554, 'medium_canopy': 170035}
2025-08-02 02:06:24,829 - __main__ - INFO - Creating enhanced temperature features...
2025-08-02 02:06:34,503 - __main__ - INFO - Created enhanced temperature features
2025-08-02 02:06:35,467 - __main__ - INFO - Creating seasonal features...
2025-08-02 02:06:47,817 - __main__ - INFO - Created seasonal features
2025-08-02 02:06:48,525 - __main__ - INFO - Creating two-way interactions...
2025-08-02 02:06:52,378 - __main__ - INFO - Created 2 two-way interaction features
2025-08-02 02:06:53,613 - __main__ - INFO - Removing redundant categorical columns...
2025-08-02 02:06:55,738 - __main__ - INFO - Removed 7 categorical columns
2025-08-02 02:06:57,144 - __main__ - INFO - Feature engineering completed for train: 83 features
2025-08-02 02:06:57,144 - __main__ - INFO - Processing validation split...
2025-08-02 02:06:57,815 - __main__ - INFO - Engineering features for validation split...
2025-08-02 02:06:57,819 - __main__ - INFO - Creating humidity bins...
2025-08-02 02:07:00,170 - __main__ - INFO - Created humidity bins: ['RH_low', 'RH_mid', 'RH_high']
2025-08-02 02:07:00,326 - __main__ - INFO - Humidity distribution: {'RH_high': 1369090, 'RH_mid': 1224071, 'RH_low': 124542}
2025-08-02 02:07:00,331 - __main__ - INFO - Creating precipitation bins...
2025-08-02 02:07:01,550 - __main__ - INFO - Created precipitation bins: ['rain_days_0_1mm', 'rain_days_1_10mm', 'rain_days_10_plus']
2025-08-02 02:07:01,680 - __main__ - INFO - Precipitation distribution: {'rain_days_0_1mm': 2717703}
2025-08-02 02:07:01,749 - __main__ - INFO - Creating socioeconomic bins...
2025-08-02 02:07:03,176 - __main__ - INFO - GDP categories created with quantiles: [10951. 16171.]
2025-08-02 02:07:04,528 - __main__ - INFO - Population categories created with quantiles: [146. 758.]
2025-08-02 02:07:05,840 - __main__ - INFO - Nightlight categories created: ['rural', 'urban_low', 'urban_high']
2025-08-02 02:07:06,009 - __main__ - INFO - Creating canopy bins...
2025-08-02 02:07:07,700 - __main__ - INFO - Canopy categories: ['no_canopy', 'low_canopy', 'medium_canopy', 'high_canopy']
2025-08-02 02:07:07,934 - __main__ - INFO - Canopy distribution: {'unknown': 2078607, 'no_canopy': 539976, 'high_canopy': 85446, 'medium_canopy': 13674}
2025-08-02 02:07:08,052 - __main__ - INFO - Creating enhanced temperature features...
2025-08-02 02:07:10,178 - __main__ - INFO - Created enhanced temperature features
2025-08-02 02:07:10,320 - __main__ - INFO - Creating seasonal features...
2025-08-02 02:07:12,406 - __main__ - INFO - Created seasonal features
2025-08-02 02:07:12,544 - __main__ - INFO - Creating two-way interactions...
2025-08-02 02:07:13,205 - __main__ - INFO - Created 2 two-way interaction features
2025-08-02 02:07:13,343 - __main__ - INFO - Removing redundant categorical columns...
2025-08-02 02:07:13,729 - __main__ - INFO - Removed 7 categorical columns
2025-08-02 02:07:13,992 - __main__ - INFO - Feature engineering completed for validation: 81 features
2025-08-02 02:07:13,993 - __main__ - INFO - Processing test split...
2025-08-02 02:07:14,067 - __main__ - INFO - Engineering features for test split...
2025-08-02 02:07:14,067 - __main__ - INFO - Creating humidity bins...
2025-08-02 02:07:16,425 - __main__ - INFO - Created humidity bins: ['RH_low', 'RH_mid', 'RH_high']
2025-08-02 02:07:16,563 - __main__ - INFO - Humidity distribution: {'RH_mid': 1359069, 'RH_high': 1217096, 'RH_low': 141529}
2025-08-02 02:07:16,563 - __main__ - INFO - Creating precipitation bins...
2025-08-02 02:07:17,789 - __main__ - INFO - Created precipitation bins: ['rain_days_0_1mm', 'rain_days_1_10mm', 'rain_days_10_plus']
2025-08-02 02:07:17,935 - __main__ - INFO - Precipitation distribution: {'rain_days_0_1mm': 2717694}
2025-08-02 02:07:18,005 - __main__ - INFO - Creating socioeconomic bins...
2025-08-02 02:07:19,342 - __main__ - INFO - GDP categories created with quantiles: [11480. 17118.]
2025-08-02 02:07:20,565 - __main__ - INFO - Population categories created with quantiles: [147. 760.]
2025-08-02 02:07:21,870 - __main__ - INFO - Nightlight categories created: ['rural', 'urban_low', 'urban_high']
2025-08-02 02:07:21,960 - __main__ - INFO - Creating canopy bins...
2025-08-02 02:07:23,603 - __main__ - INFO - Canopy categories: ['no_canopy', 'low_canopy', 'medium_canopy', 'high_canopy']
2025-08-02 02:07:23,735 - __main__ - INFO - Canopy distribution: {'unknown': 2078510, 'no_canopy': 540760, 'high_canopy': 83377, 'medium_canopy': 15047}
2025-08-02 02:07:23,848 - __main__ - INFO - Creating enhanced temperature features...
2025-08-02 02:07:26,025 - __main__ - INFO - Created enhanced temperature features
2025-08-02 02:07:26,160 - __main__ - INFO - Creating seasonal features...
2025-08-02 02:07:28,203 - __main__ - INFO - Created seasonal features
2025-08-02 02:07:28,342 - __main__ - INFO - Creating two-way interactions...
2025-08-02 02:07:28,963 - __main__ - INFO - Created 2 two-way interaction features
2025-08-02 02:07:29,100 - __main__ - INFO - Removing redundant categorical columns...
2025-08-02 02:07:29,422 - __main__ - INFO - Removed 7 categorical columns
2025-08-02 02:07:29,646 - __main__ - INFO - Feature engineering completed for test: 81 features
2025-08-02 02:07:29,646 - __main__ - INFO - Validating engineered features...
2025-08-02 02:07:39,109 - __main__ - INFO - Feature Engineering Validation:
2025-08-02 02:07:39,109 - __main__ - INFO -   Total features: 83
2025-08-02 02:07:39,109 - __main__ - INFO -   original: 56 features
2025-08-02 02:07:39,109 - __main__ - INFO -   temperature_derived: 7 features
2025-08-02 02:07:39,109 - __main__ - INFO -   categorical_dummies: 26 features
2025-08-02 02:07:39,109 - __main__ - INFO -   interactions: 14 features
2025-08-02 02:07:39,109 - __main__ - INFO -   seasonal: 6 features
2025-08-02 02:07:39,109 - __main__ - INFO -   Missing data columns: 17
2025-08-02 02:07:57,816 - __main__ - INFO - Saved train engineered dataset: G:\research\junmao-tang\code-test\code-space\data\processed\ml_analysis\engineered\train_engineered.parquet
2025-08-02 02:08:01,670 - __main__ - INFO - Saved validation engineered dataset: G:\research\junmao-tang\code-test\code-space\data\processed\ml_analysis\engineered\validation_engineered.parquet
2025-08-02 02:08:05,462 - __main__ - INFO - Saved test engineered dataset: G:\research\junmao-tang\code-test\code-space\data\processed\ml_analysis\engineered\test_engineered.parquet
2025-08-02 02:08:05,466 - __main__ - INFO - Saved feature engineering metadata: G:\research\junmao-tang\code-test\code-space\data\processed\ml_analysis\engineered\feature_engineering_metadata.json
2025-08-02 02:08:05,466 - __main__ - ERROR - Error during feature engineering: 'full'
